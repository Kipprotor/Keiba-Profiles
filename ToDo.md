## TODO 

## バグ修正
## 機能
- [x] lookupID 名前から HorseID を取得する関数
- [ ] 名前で検索して競走馬の情報を得る機能・関数
  - 同じ名前の競走馬がいた場合どうするか
    - この機能を、HorseIDを調べるAPIとHorseIDから情報を検索する機能に分ける。
      - HorseIDを調べるためだけにhtmlをダウンロードしてくるのは無駄が多いので、以下の案を思いついた
        1. ヒットしたのが1件だけなら body にページの html を代入して返す。
        1. ヒットしたのが１件以上の場合は、bodyに検索結果の html
           を代入して返す。
    - オプション引数を使う。
      - ~~何年に生まれたか指定するオプション~~ netkeiba.com で生年を指定して検索することができなかったから。この機能の実装は断念する。
      - オプション引数の指定がなかった場合は、ヒットした競走馬すべての情報をそれぞれ得る設定にしよう。
      - 検索にヒットした競走馬すべての詳細情報を得るオプション

- [x] HorseID から競走馬の情報を得る機能・関数
  - wrapper.ts の profileByID として実装済み
  - HorseIDは一意的なものだから search を名前に使うのは間違っている気がする。
  - HorseID を取得するために一度リクエストを送る必要がある
    - 同名の馬がいなかった場合そのままプロフィールにリダイレクトされるのだけど、そこから
      HorseID だけしか取ってこないというのはもったいないと思う

- [ ] 馬名以外からも検索できる機能を実装する。
  - 検索項目は、馬名、父名、母名、母父名、馬主、生産者の5つを将来的には実装予定
  - 1ページあたり最大100件まで検索結果を表示できるとはいえ、それでも検索結果が数ページに渡ることがある。
    - [ ] ページ数が数ページに渡った場合
      - 状況: flipSearchRsltPage.ts でプロトタイプを作成中
      1. url の &page パラメータの数値+1 する
      1. そのurlにアクセスし、そのページをスクレイピングする。
      1. 検索結果の表の列がある限りはこの処理を繰り返す。
    - このようにして、ページ移動は実装しようと思う。

- [x] 検索機能とHTMLをスクレイピングする機能を分割する。
  1. urlを生成して、http を取得する機能 -> generateURL from "crawler.ts"
  1. html をスクレイピングする機能 -> scraper.ts
  1. 上2つを1箇所から使えるようにする機能 -> wrapper.ts

- ~~[ ] selectHorseInfo~~
  - ~~fetch みたいに {select:name,sex,..}
    みたいに欲しい情報を指定できるようになるといいかも~~
  - 競走馬の情報は辞書型で格納すれば、指定オプションを読み取る機能を作る必要がなくなるし、指定オプションについてドキュメントを読む必要がなくなる。

- [x] 競走馬の情報を辞書型で格納し直す。
  - 辞書型のメリットは、鍵が値の説明になっていることだ。
  - ほぼ完了 2024/01/02
  - 完了 2024/01/05
- [x]  レースの結果をスクレイピングする関数を作る。
  - [ ] 一つ以上の情報を含む、表の見出しを分ける
  - [ ] データの格納にあたって、日付やタイムなど、 string型以外を使うべきデータの型をどう変換すべきか?
## 仕様の決定
- [x] lookupID の返り値はかなり大きな配列(要素が100個以上)になることがそこそこあるから、lookupID を generater にするか考え中。
  - AsyncGenerater として実装。 2024/03/27
## ドキュメント作成/修正
- [ ] 仕様が固まり、実装が終了したものから優先的に JS/TSDocs を追記する。
- [ ] 関数の説明と、使い方/実装例を追加する。
